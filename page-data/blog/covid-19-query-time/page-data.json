{"componentChunkName":"component---src-templates-post-js","path":"/blog/covid-19-query-time/","result":{"data":{"markdownRemark":{"html":"<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1rem\" > <iframe src=\"https://www.youtube.com/embed/_We0zGK3aWY\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<h2>More problems have arisen! They changed the format of the CSV files in the Github Repository.</h2>\n<p>Gee whiz! Well that is something that we can fix, and at the same time make our code a little more robust.</p>\n<p>Before we do that though, let’s look at the data we already do have. To do that, we need to write a few QUERY statements to shine a little clarity on our situation. This won’t be an exhaustive tutorial on the QUERY function, however, it will give you just enough information to get you into trouble.</p>\n<p>First we can bring in our data with a little bit of a filter. Specifically a filter by date.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\">=QUERY(&#39;COVID-19 Daily Reports&#39;!A:I, &quot;select B, C, E, F, G WHERE A = date &#39;&quot;&amp; TEXT(H1, &quot;yyyy-mm-dd&quot;)&amp;&quot;&#39;&quot;, 1)</code></pre></div>\n<p>Then we can add in a Country filter, and a little extra data for fun.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\">=TRANSPOSE(QUERY(A2:E, &quot;select sum(C), sum(D), sum(E) WHERE B = &#39;&quot;&amp;H2&amp;&quot;&#39; LABEL sum(C) &#39;Confirmed&#39;, sum(D) &#39;Death&#39;, sum(E) &#39;Recovered&#39;&quot;, -1))</code></pre></div>\n<p>Lets add a sheet that</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\">=QUERY(&#39;COVID-19 Daily Reports&#39;!A:I, &quot;select A, count(B), sum(E), sum(F), sum(G) WHERE A is not null GROUP BY A LABEL count(B) &#39;Countries&#39;&quot;, 1)</code></pre></div>\n<p>Comment below if you have comments or suggestions. For a more exhaustive look at the <code class=\"language-text\">QUERY</code> function, <a href=\"https://www.benlcollins.com/spreadsheets/google-sheets-query-sql/\">check out this post from Ben Collins</a>!</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-resp-iframe-wrapper"],"style":"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1rem"},"children":[{"type":"text","value":" "},{"type":"element","tagName":"iframe","properties":{"src":"https://www.youtube.com/embed/_We0zGK3aWY","frameBorder":"0","allow":"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowFullScreen":true,"style":" position: absolute; top: 0; left: 0; width: 100%; height: 100%; "},"children":[]},{"type":"text","value":" "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"More problems have arisen! They changed the format of the CSV files in the Github Repository."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Gee whiz! Well that is something that we can fix, and at the same time make our code a little more robust."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Before we do that though, let’s look at the data we already do have. To do that, we need to write a few QUERY statements to shine a little clarity on our situation. This won’t be an exhaustive tutorial on the QUERY function, however, it will give you just enough information to get you into trouble."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"First we can bring in our data with a little bit of a filter. Specifically a filter by date."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"text","value":"=QUERY('COVID-19 Daily Reports'!A:I, \"select B, C, E, F, G WHERE A = date '\"& TEXT(H1, \"yyyy-mm-dd\")&\"'\", 1)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then we can add in a Country filter, and a little extra data for fun."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"text","value":"=TRANSPOSE(QUERY(A2:E, \"select sum(C), sum(D), sum(E) WHERE B = '\"&H2&\"' LABEL sum(C) 'Confirmed', sum(D) 'Death', sum(E) 'Recovered'\", -1))"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lets add a sheet that"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"text","value":"=QUERY('COVID-19 Daily Reports'!A:I, \"select A, count(B), sum(E), sum(F), sum(G) WHERE A is not null GROUP BY A LABEL count(B) 'Countries'\", 1)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comment below if you have comments or suggestions. For a more exhaustive look at the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"QUERY"}]},{"type":"text","value":" function, "},{"type":"element","tagName":"a","properties":{"href":"https://www.benlcollins.com/spreadsheets/google-sheets-query-sql/"},"children":[{"type":"text","value":"check out this post from Ben Collins"}]},{"type":"text","value":"!"}]}],"data":{"quirksMode":false}},"excerpt":"More problems have arisen! They changed the format of the CSV files in the Github Repository. Gee whiz! Well that is something that we can…","timeToRead":1,"fields":{"date":"24 March 2020","slug":"/blog/covid-19-query-time/"},"frontmatter":{"title":"Covid-19 Query Time","tags":["Projects","google apps script","javascript","solutions"],"image":null}},"site":{"siteMetadata":{"siteUrl":"https://jordanrhea.com"}}},"pageContext":{"slug":"/blog/covid-19-query-time/","prev":{"excerpt":"We already pulled some data from a CSV file stored on Github. Now we need a way to update this. Here is a down and dirty implementation of…","timeToRead":1,"frontmatter":{"title":"Update Sheet from Remote CSV Files","tags":["projects","google apps script","javascript","solutions","csv","google sheets","github"],"draft":null,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7782026768642447,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDAv/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAv/aAAwDAQACEAMQAAABlqSEQRm//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAEAIhIv/aAAgBAQABBQLFTmnoFV//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPwGn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARBB/9oACAECAQE/ATF//8QAGhAAAgIDAAAAAAAAAAAAAAAAARAAESFBcf/aAAgBAQAGPwLIHZpU/wD/xAAcEAACAgIDAAAAAAAAAAAAAAABEQAhEEFRYYH/2gAIAQEAAT8haNDZy4oN7CWaC6jO1cQhMY//2gAMAwEAAgADAAAAEFjf/8QAFREBAQAAAAAAAAAAAAAAAAAAEDH/2gAIAQMBAT8Qg//EABYRAQEBAAAAAAAAAAAAAAAAAAEQYf/aAAgBAgEBPxAAan//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMRBBYZH/2gAIAQEAAT8QdE2ymWdUTMHgUAzhKiXorX2BhV231Li01WuP/9k=","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/c55e4c349e349ceda4c85f8e9cf87de8/ec6c5/thumbnail.jpg","srcSet":"/static/c55e4c349e349ceda4c85f8e9cf87de8/2f037/thumbnail.jpg 930w,\n/static/c55e4c349e349ceda4c85f8e9cf87de8/ec6c5/thumbnail.jpg 1280w"}}}},"fields":{"layout":"","slug":"/blog/update-sheet-from-remote-csv-files/","date":"2020-03-23T16:00:00.000Z"}},"next":null,"primaryTag":"Projects"}}}